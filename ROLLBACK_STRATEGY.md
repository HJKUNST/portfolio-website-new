# 롤백 전략 (Rollback Strategy)

이 문서는 배포 후 문제가 발생했을 때 이전 버전으로 되돌리는 롤백 절차를 설명합니다.

## 롤백 시나리오

### 시나리오 1: 치명적인 버그 발견
- 사이트가 전혀 로드되지 않음
- 주요 기능이 작동하지 않음
- 데이터 손실 위험

### 시나리오 2: 성능 저하
- 페이지 로딩 속도가 현저히 느려짐
- 메모리 누수 또는 CPU 사용량 급증

### 시나리오 3: 보안 취약점 발견
- 보안 패치가 필요한 상황
- 민감한 정보 노출 위험

## 롤백 방법

### 방법 1: Vercel 대시보드를 통한 롤백 (권장)

**절차:**
1. Vercel 대시보드 접속
2. 프로젝트 선택
3. "Deployments" 탭으로 이동
4. 이전 정상 배포 버전 선택
5. "..." 메뉴 클릭 → "Promote to Production" 선택
6. 롤백 확인

**장점:**
- 빠른 롤백 (1-2분 내)
- 코드 변경 불필요
- 자동으로 트래픽 전환

**단점:**
- Vercel 플랫폼에 의존

### 방법 2: Git을 통한 롤백

**절차:**
```bash
# 1. 이전 커밋 확인
git log --oneline -10

# 2. 이전 정상 버전의 커밋 해시 확인
# 예: abc1234 (이전 정상 버전)

# 3. 이전 버전으로 체크아웃
git checkout abc1234

# 4. 새 브랜치 생성 (선택사항)
git checkout -b hotfix/rollback

# 5. main 브랜치로 돌아가서 병합
git checkout main
git merge hotfix/rollback

# 6. 푸시 (Vercel 자동 배포 트리거)
git push origin main
```

**주의사항:**
- 팀과 사전 협의 필요
- Force push는 피해야 함
- 롤백 커밋에 명확한 메시지 작성

### 방법 3: Vercel CLI를 통한 롤백

**절차:**
```bash
# 1. 배포 목록 확인
vercel ls

# 2. 이전 배포 ID 확인
# 예: abc123.vercel.app

# 3. 롤백 실행
vercel rollback [deployment-url]
```

## 롤백 전 확인사항

### 1. 문제 확인
- [ ] 문제의 심각도 평가
- [ ] 영향 범위 확인 (전체 vs 일부 기능)
- [ ] 사용자 영향도 확인

### 2. 롤백 대상 확인
- [ ] 이전 정상 버전의 배포 ID 확인
- [ ] 해당 버전의 기능 목록 확인
- [ ] 롤백 시 손실될 기능 확인

### 3. 팀 공유
- [ ] 팀원들에게 롤백 계획 공유
- [ ] 롤백 이유 문서화
- [ ] 롤백 후 조치 계획 수립

## 롤백 후 조치

### 1. 즉시 조치
- [ ] 롤백 완료 확인
- [ ] 사이트 정상 동작 확인
- [ ] 주요 기능 테스트

### 2. 문제 분석
- [ ] 문제 원인 분석
- [ ] 버그 리포트 작성
- [ ] 재발 방지 방안 수립

### 3. 재배포 계획
- [ ] 문제 수정
- [ ] 테스트 강화
- [ ] 재배포 일정 수립

## 롤백 체크리스트

### 롤백 전
- [ ] 문제 심각도 평가 완료
- [ ] 이전 정상 버전 확인 완료
- [ ] 팀원 공유 완료
- [ ] 롤백 방법 결정 완료

### 롤백 중
- [ ] 롤백 프로세스 실행
- [ ] 배포 상태 모니터링
- [ ] 에러 로그 확인

### 롤백 후
- [ ] 사이트 정상 동작 확인
- [ ] 주요 기능 테스트 완료
- [ ] 사용자 영향 최소화 확인
- [ ] 문제 원인 분석 시작

## 예방 조치

### 1. 배포 전
- 철저한 테스트 수행
- 스테이징 환경에서 사전 검증
- 코드 리뷰 강화

### 2. 배포 중
- 점진적 배포 (Canary Deployment)
- 실시간 모니터링
- 빠른 롤백 준비

### 3. 배포 후
- Smoke Test 즉시 수행
- 모니터링 강화
- 사용자 피드백 수집

## 롤백 연습

정기적으로 롤백 절차를 연습하여 실제 상황에서 빠르게 대응할 수 있도록 준비하세요.

**연습 시나리오:**
1. 테스트 환경에서 롤백 절차 실행
2. 롤백 소요 시간 측정
3. 롤백 절차 문서 업데이트

## 비상 연락처

롤백이 필요한 경우 다음 순서로 연락:

1. 개발팀 리드
2. DevOps 팀
3. 프로젝트 매니저

---

**마지막 업데이트**: 2024년
**문서 버전**: 1.0

